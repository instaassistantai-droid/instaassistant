<script src="https://unpkg.com/@supabase/supabase-js@1.35.7/dist/umd/supabase.js"></script>

<script>
/* ===== 1️⃣ SUPABASE INIT (TOP MOST) ===== */
const SUPABASE_URL = "https://ymbhbwnsoxbfusltoazm.supabase.co";
const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InltYmhid25zb3hiZnVzbHRvYXptIiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk1Nzc1MzMsImV4cCI6MjA4NTE1MzUzM30.zN743oVTAKPrfX4PAs1oBjUiszy6nAae6a_NTYhGPCE";

const supabase = window.supabase.createClient(
  SUPABASE_URL,
  SUPABASE_KEY
);

/* ===== 2️⃣ AUTH CHECK ===== */
const user = supabase.auth.user();
if (!user) {
  window.location.href = "/login.html";
}

/* ===== 3️⃣ FUNCTIONS ===== */

async function logout() {
  await supabase.auth.signOut();
  window.location.href = "/login.html";
}

async function saveProfile() {
  const bio = document.getElementById("bio").value;

  await supabase
    .from("creators")
    .update({ bio })
    .eq("id", user.id);

  alert("Profile saved ✅");
}

async function connectInstagram() {
  const username = document.getElementById("ig_username").value;
  const followers = document.getElementById("ig_followers").value;
  const niche = document.getElementById("ig_niche").value;
  const goals = document.getElementById("ig_goals").value;

  await supabase.from("social_accounts").insert({
    user_id: user.id,
    platform: "instagram",
    username,
    followers,
    niche,
    goals
  });

  alert("Instagram connected ✅");
}
</script>
